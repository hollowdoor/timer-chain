{"version":3,"file":"timer-chain.min.js","sources":["../node_modules/more-events/dist/bundle.es.js","../src/index.js"],"sourcesContent":["var Handler = function Handler(name, listener, matchListener){\n    if ( matchListener === void 0 ) matchListener = null;\n\n    this.name = name;\n    this.matchListener = this.listener = listener;\n    if(matchListener !== null){\n        this.matchListener = matchListener;\n    }\n};\n\nvar MoreEvents = function MoreEvents(context){\n    this.listeners = {};\n    this.__context = context === void 0 ? this : context;\n};\nMoreEvents.prototype.addListener = function addListener (name, listener, matchListener){\n    if(this.listeners[name] === void 0){\n        this.listeners[name] = [];\n    }\n    this.listeners[name].push(new Handler(name, listener, matchListener));\n\n    return this;\n};\nMoreEvents.prototype.removeListener = function removeListener (name, listener){\n        var this$1 = this;\n\n    if(this.listeners[name] === void 0 || !this.listeners[name].length)\n        { return this; }\n\n    for(var i=0; i<this.listeners[name].length; i++){\n        var current = this$1.listeners[name][i];\n        //The matchListener might be different\n        //than the actual listener\n        if(current.matchListener === listener){\n            this$1.listeners[name].splice(i, 1);\n            --i;\n        }\n    }\n\n    return this;\n};\nMoreEvents.prototype.emitListeners = function emitListeners (name){\n        var this$1 = this;\n        var args = [], len = arguments.length - 1;\n        while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n    if(this.listeners[name] === void 0 || !this.listeners[name].length) { return; }\n\n    for(var i=0; i<this.listeners[name].length; i++){\n        (this$1.listeners[name][i].listener)\n        .apply(this$1.__context, args);\n    }\n    return this;\n};\nMoreEvents.prototype.removeAll = function removeAll (name){\n    delete this.listeners[name];\n};\nMoreEvents.prototype.dispose = function dispose (){\n    this.listeners = this.__context = null;\n};\n\nvar Emitter = (function (MoreEvents) {\n    function Emitter(context){\n        MoreEvents.call(this, context);\n    }\n\n    if ( MoreEvents ) Emitter.__proto__ = MoreEvents;\n    Emitter.prototype = Object.create( MoreEvents && MoreEvents.prototype );\n    Emitter.prototype.constructor = Emitter;\n    Emitter.prototype.on = function on (name, listener){\n        return this.addListener(name, listener);\n    };\n    Emitter.prototype.off = function off (name, listener){\n        return this.removeListener(name, listener);\n    };\n    Emitter.prototype.one = function one (name, listener){\n        return this.on(name, onceListener);\n    };\n    Emitter.prototype.emit = function emit (name){\n        var args = [], len = arguments.length - 1;\n        while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n        return (ref = this).emitListeners.apply(ref, [ name ].concat( args ));\n        var ref;\n    };\n    Emitter.prototype.clear = function clear (name){\n        this.removeAll(name);\n    };\n\n    return Emitter;\n}(MoreEvents));\n\nexport { Emitter };\n//# sourceMappingURL=bundle.es.js.map\n","import {Emitter} from 'more-events';\nconst now = Date.now ? Date.now : ()=>new Date().getTime();\n\nexport default class TimerChain extends Emitter {\n    constructor(list = [], {\n        sync = true\n    } = {}){\n        super();\n\n        let current = list[0];\n\n        this.list = list;\n        this.index = 0;\n        this.synchronize = sync;\n\n        Object.defineProperty(this, 'current', {\n            get(){ return current; }\n        });\n\n        const onTick = (...args)=>{\n            return this.emit('tick', ...args);\n        };\n\n        current.on('tick', onTick);\n\n        list.forEach((timer, i)=>{\n\n            if(typeof timer.start !== 'function'){\n                throw new Error(`Timer does not have a start method`);\n            }\n\n            if(i === list.length - 1){\n                timer.on('complete', ()=>{\n                    this.emit('complete');\n                });\n                return;\n            }\n\n            timer.on('complete', (time)=>{\n                current.off('tick', onTick);\n                let present = now();\n                current = list[++this.index];\n                current.on('tick', onTick);\n                let diff = present - time;\n                let wait = current.interval - diff;\n                current.start(wait);\n            });\n        });\n    }\n    start(){\n        if(typeof this.current.start !== 'function'){\n            throw new Error(`Timer does not have a start method`);\n        }\n        console.log('this.current ',this.current)\n        this.current.start();\n        this.emit('start', this.current.startTime || now());\n        return this;\n    }\n    pause(){\n        if(typeof this.current.pause !== 'function'){\n            throw new Error(`Timer does not have a pause method`);\n        }\n        this.current.pause();\n        this.emit('pause');\n        return this;\n    }\n    stop(){\n        if(typeof this.current.stop !== 'function'){\n            throw new Error(`Timer does not have a stop method`);\n        }\n        this.current.stop();\n        this.emit('stop');\n        return this;\n    }\n}\n"],"names":["MoreEvents","context","this","listeners","__context","prototype","addListener","name","listener","matchListener","push","removeListener","length","i","splice","emitListeners","args","len","arguments","apply","removeAll","dispose","Emitter","call","__proto__","Object","create","constructor","on","off","one","onceListener","emit","ref","concat","clear","now","Date","getTime","list","super","let","current","index","synchronize","sync","defineProperty","get","const","onTick","forEach","timer","start","Error","time","present","diff","wait","interval","console","log","startTime","pause","stop"],"mappings":"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"}